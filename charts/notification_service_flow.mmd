graph TD
    A[Запуск сервиса уведомлений] --> B[Установка интервала проверки]
    B --> C{Проверка каждую минуту}
    C --> D[Получение активных задач]
    D --> E{Есть задачи для уведомления?}
    E -->|Да| F[Обработка каждой задачи]
    E -->|Нет| C
    F --> G[Форматирование сообщения]
    G --> H{Отправка уведомления}
    H -->|Успешно| I[Запись в историю: статус sent]
    H -->|Ошибка| J[Запись в историю: статус failed]
    I --> C
    J --> C

    subgraph Форматирование сообщения
        G --> G1[Добавление заголовка]
        G1 --> G2[Добавление названия задачи]
        G2 --> G3[Добавление срока]
        G3 --> G4[Добавление категории]
        G4 --> G5[Добавление описания если есть]
    end

    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B fill:#bbf,stroke:#333,stroke-width:2px
    style C fill:#dfd,stroke:#333,stroke-width:2px
    style E fill:#ffd,stroke:#333,stroke-width:2px
    style H fill:#ffd,stroke:#333,stroke-width:2px 